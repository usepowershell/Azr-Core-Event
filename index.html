<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure Core Underground 2026</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Hero Section -->
    <section class="hero">
        <h1>Azure Core Underground 2026</h1>
        <p class="tagline">Azure Core Underground - a community event focused on compute, network, and storage in Azure.</p>
        
        <div>
            <a href="#about" class="cta">About</a>
            <a href="#schedule" class="cta">Schedule</a>
            <a href="#speakers" class="cta">Speakers</a>
            <a href="#sponsors" class="cta">Sponsors</a>
        </div>
    </section>

    <!-- Video Player Section -->
    <section id="video" class="video-section">
        <div class="video-container" id="video-container">
            <img src="assets/Loading-Schedule.png" alt="Loading schedule..." id="video-placeholder">
        </div>
    </section>

    <!-- About Section -->
    <section id="about">
        <h2>About This Event</h2>
        <p class="section-subtitle">
            <strong>Azure Core Underground</strong> is a deep-technical, engineering-led, Azure infrastructure event 
            built for the people who actually <em>run</em> Azure in production. If you've ever been on call at 2am wondering why something broke, or how to stop it from breaking again - you're in the right place.<br>
            It's about <strong>how Azure behaves in the real world</strong>, and what that means for the people designing, operating, and securing infrastructure at scale. Less theory. Fewer slides. More reality.
        </p>
        <p class="section-subtitle" style="margin-bottom: 1.5rem;">
            The entire event is organized around three core pillars that map directly to how Azure infrastructure is actually used in production.
        </p>
        
        <div class="features-grid">
            <div class="feature-card">
                <h3>ðŸ§± Build Azure Infrastructure</h3>
                <p>How to design Azure infrastructure you won't regret six months later. Sessions cover architecture, landing zones, infrastructure as code, and designing for resilience, security, and scale.</p>
            </div>
            <div class="feature-card">
                <h3>ðŸ”§ Operate Azure Workloads</h3>
                <p>How to keep Azure stable, secure, and manageable when it's under pressure. Focus on day-2 operations: monitoring, governance, patching, identity, and hybrid operations.</p>
            </div>
            <div class="feature-card">
                <h3>ðŸš€ Optimize Azure at Scale</h3>
                <p>How to improve performance, control costs, and reduce risk without breaking what already works. Practical guidance rooted in real telemetry and real constraints.</p>
            </div>
            <div class="feature-card">
                <h3>ðŸ‘¥ Who It's For</h3>
                <p>IT professionals running Azure in production, infrastructure/platform/SRE engineers, hybrid and enterprise operations teams, and anyone who cares about blast radius and operational tradeoffs.</p>
            </div>
        </div>
    </section>

    <!-- Schedule Section -->
    <section id="schedule">
        <h2>Event Schedule</h2>
        
        <div id="schedule-container" class="schedule-days">
            <p class="loading">Loading schedule...</p>
        </div>
    </section>

    <!-- Speakers Section -->
    <section id="speakers">
        <h2>Featured Speakers</h2>
        <p class="section-subtitle">Learn from Microsoft engineers and industry experts.</p>
        
        <div class="speakers-grid">
            <div class="speaker-card">
                <div class="speaker-avatar">RC</div>
                <h4>Rick Claus</h4>
                <p>Principal Cloud Advocate</p>
            </div>
            <div class="speaker-card">
                <div class="speaker-avatar">PR</div>
                <h4>Pierre Roman</h4>
                <p>Senior Cloud Advocate</p>
            </div>
            <div class="speaker-card">
                <div class="speaker-avatar">VS</div>
                <h4>Vinicius Souza</h4>
                <p>Cloud Advocate</p>
            </div>
            <div class="speaker-card">
                <div class="speaker-avatar">DW</div>
                <h4>Davanna White</h4>
                <p>Product Manager</p>
            </div>
            <div class="speaker-card">
                <div class="speaker-avatar">AP</div>
                <h4>Artem Pronichkin</h4>
                <p>Principal Program Manager</p>
            </div>
        </div>
    </section>

    <!-- Sponsors Section -->
    <section id="sponsors" class="sponsors-section">
        <h2>Our Sponsors</h2>
        <p class="section-subtitle">Thank you to our sponsors for making this event possible.</p>
        
        <div class="sponsors-grid">
            <div class="sponsor-logo">Microsoft</div>
            <div class="sponsor-logo">Azure</div>
            <div class="sponsor-logo">Your Company Here</div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
        <h2>Stay Connected</h2>
        <p class="section-subtitle">Follow us for the latest news and updates about Azure Core Underground.</p>
        <div>
            <a href="#" class="cta">Sign Up for Updates</a>
            <a href="https://twitter.com/search?q=AzureCoreUnderground" class="cta secondary" target="_blank">#AzureCoreUnderground</a>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-links">
            <a href="#">Privacy Policy</a>
            <a href="#">Code of Conduct</a>
            <a href="https://azure.microsoft.com" target="_blank">Powered by Azure</a>
        </div>
        <p class="copyright">Â© 2026 Azure Core Underground. All rights reserved.</p>
    </footer>

    <!-- Session Modal -->
    <div id="session-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">&times;</button>
            <div class="modal-time" id="modal-time"></div>
            <h2 class="modal-title" id="modal-title"></h2>
            <div class="modal-description" id="modal-description"></div>
            <div class="modal-actions">
                <a id="modal-youtube" href="#" target="_blank" class="btn-watch">
                    â–¶ Watch on YouTube
                </a>
            </div>
        </div>
    </div>

    <!-- YouTube IFrame API -->
    <script src="https://www.youtube.com/iframe_api"></script>
    
    <script>
        let scheduleData = [];
        let youtubePlayer = null;
        
        function onYouTubeIframeAPIReady() {
            // API is ready, player will be created when needed
        }
        
        function updateVideoPlayer() {
            const container = document.getElementById('video-container');
            const now = new Date();
            
            if (scheduleData.length === 0) {
                container.innerHTML = '<img src="assets/OnDemand.png" alt="Watch on demand">';
                return;
            }
            
            // Find currently playing session
            let currentSession = null;
            let hasUpcoming = false;
            
            for (const session of scheduleData) {
                const startTime = new Date(session.startTime);
                const endTime = new Date(startTime.getTime() + (session.duration || 3600) * 1000);
                
                if (now >= startTime && now < endTime) {
                    currentSession = session;
                    break;
                }
                
                if (startTime > now) {
                    hasUpcoming = true;
                }
            }
            
            if (currentSession) {
                // Play the current session
                const videoId = currentSession.videoId || extractVideoId(currentSession.url);
                if (videoId) {
                    // Create a placeholder div for the YouTube player
                    container.innerHTML = `
                        <div id="youtube-player"></div>
                        <div class="video-overlay" id="video-overlay">
                            <div class="now-playing">Now Playing</div>
                            <div class="video-title">${escapeHtml(currentSession.title)}</div>
                        </div>`;
                    
                    // Create YouTube player with error handling
                    if (youtubePlayer) {
                        youtubePlayer.destroy();
                    }
                    
                    youtubePlayer = new YT.Player('youtube-player', {
                        videoId: videoId,
                        playerVars: {
                            autoplay: 1,
                            modestbranding: 1,
                            rel: 0
                        },
                        events: {
                            onReady: function(event) {
                                // Hide overlay after a few seconds
                                setTimeout(() => {
                                    const overlay = document.getElementById('video-overlay');
                                    if (overlay) overlay.style.opacity = '0';
                                }, 5000);
                            },
                            onError: function(event) {
                                // Video can't be played - show link to watch on YouTube
                                container.innerHTML = `
                                    <div class="video-error">
                                        <img src="assets/BRB.jpg" alt="Video unavailable" class="error-bg">
                                        <div class="error-overlay">
                                            <p class="error-title">Now Playing: ${escapeHtml(currentSession.title)}</p>
                                            <p class="error-message">This video cannot be embedded.</p>
                                            <a href="${currentSession.url}" target="_blank" class="btn-watch-large">â–¶ Watch on YouTube</a>
                                        </div>
                                    </div>`;
                            }
                        }
                    });
                } else {
                    container.innerHTML = '<img src="assets/BRB.jpg" alt="Be right back">';
                }
            } else if (hasUpcoming) {
                // Gap in schedule - show BRB
                container.innerHTML = '<img src="assets/BRB.jpg" alt="Be right back">';
            } else {
                // All sessions are in the past - show on demand
                container.innerHTML = '<img src="assets/OnDemand.png" alt="Watch on demand">';
            }
        }
        
        function extractVideoId(url) {
            if (!url) return null;
            const match = url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\s]+)/);
            return match ? match[1] : null;
        }
        
        async function loadSchedule() {
            const container = document.getElementById('schedule-container');
            
            try {
                const response = await fetch('/api/schedule');
                const data = await response.json();
                scheduleData = data.schedule || [];
                
                // Update video player based on schedule
                updateVideoPlayer();
                
                if (scheduleData.length === 0) {
                    container.innerHTML = '<p>No sessions scheduled yet.</p>';
                    return;
                }
                
                // Group sessions by date
                const sessionsByDay = {};
                scheduleData.forEach(session => {
                    const date = new Date(session.startTime);
                    const dayKey = date.toLocaleDateString('en-US', { 
                        weekday: 'long', 
                        month: 'long', 
                        day: 'numeric' 
                    });
                    
                    if (!sessionsByDay[dayKey]) {
                        sessionsByDay[dayKey] = [];
                    }
                    sessionsByDay[dayKey].push(session);
                });
                
                // Sort days chronologically
                const sortedDays = Object.keys(sessionsByDay).sort((a, b) => {
                    const dateA = new Date(sessionsByDay[a][0].startTime);
                    const dateB = new Date(sessionsByDay[b][0].startTime);
                    return dateA - dateB;
                });
                
                // Build HTML
                let html = '';
                sortedDays.forEach((day, index) => {
                    const sessions = sessionsByDay[day];
                    html += `<div class="schedule-day">`;
                    html += `<h3>Day ${index + 1} - ${day}</h3>`;
                    html += `<div class="day-sessions">`;
                    
                    sessions.forEach(session => {
                        const time = new Date(session.startTime).toLocaleTimeString('en-US', {
                            hour: 'numeric',
                            minute: '2-digit',
                            timeZoneName: 'short'
                        });
                        
                        const truncatedDesc = session.description 
                            ? session.description.substring(0, 120) + '...' 
                            : '';
                        
                        html += `
                            <div class="session-card" onclick="openSession('${session.id}')">
                                <div class="session-time">${time}</div>
                                <h4>${escapeHtml(session.title)}</h4>
                                <p>${escapeHtml(truncatedDesc)}</p>
                            </div>
                        `;
                    });
                    
                    html += `</div></div>`;
                });
                
                container.innerHTML = html;
                
            } catch (error) {
                console.error('Error loading schedule:', error);
                container.innerHTML = '<p>Unable to load schedule. Please try again later.</p>';
            }
        }
        
        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        function openSession(sessionId) {
            const session = scheduleData.find(s => s.id === sessionId);
            if (!session) return;
            
            const time = new Date(session.startTime).toLocaleString('en-US', {
                weekday: 'long',
                month: 'long',
                day: 'numeric',
                hour: 'numeric',
                minute: '2-digit',
                timeZoneName: 'short'
            });
            
            document.getElementById('modal-time').textContent = time;
            document.getElementById('modal-title').textContent = session.title;
            document.getElementById('modal-description').textContent = session.description || 'No description available.';
            document.getElementById('modal-youtube').href = session.url || '#';
            
            document.getElementById('session-modal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeModal() {
            document.getElementById('session-modal').classList.remove('active');
            document.body.style.overflow = '';
        }
        
        // Close modal on overlay click
        document.getElementById('session-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
        
        // Close modal on Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });
        
        // Load schedule when page loads
        document.addEventListener('DOMContentLoaded', loadSchedule);
    </script>

</body>
</html>
